MAG2305 version: UnetHd_Public_2023.10.18

c_gn_test
Unet model loaded

Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 2048
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([32, 32, 2, 3])
||Unt_size: 32 || Spin calc speed: 1.4e-02 s || Hd calc speed: 1.2e-02 s||
MAG2305 version: UnetHd_Public_2023.10.18


Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 2048
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([32, 32, 2, 3])
Demag Matrix SumTest:
  [ 2.65687e-01 -1.64968e-01 -9.15766e-02]
  [-1.64968e-01  2.65687e-01 -9.15766e-02]
  [-9.15766e-02 -9.15766e-02  4.68626e-01]
  trace = 1.00000

Time cost: 0.647739 s for getting demag matrix 

||MAG_size: 32 || Spin calc speed: 1.1e-02 s || Hd calc speed: 5.9e-03 s||


 +---------------------------Results Summary-----------------------------+
||Unt_size: 32 || Spin calc speed: 1.4e-02 s || Hd calc speed: 1.2e-02 s||
||MAG_size: 32 || Spin calc speed: 1.1e-02 s || Hd calc speed: 5.9e-03 s||
MAG2305 version: UnetHd_Public_2023.10.18

c_gn_test
Unet model loaded

Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 8192
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([64, 64, 2, 3])
||Unt_size: 64 || Spin calc speed: 1.5e-02 s || Hd calc speed: 9.9e-03 s||
MAG2305 version: UnetHd_Public_2023.10.18


Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 8192
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([64, 64, 2, 3])
Demag Matrix SumTest:
  [ 2.63859e-01 -1.68257e-01 -9.16506e-02]
  [-1.68257e-01  2.63859e-01 -9.16506e-02]
  [-9.16506e-02 -9.16506e-02  4.72282e-01]
  trace = 1.00000

Time cost: 1.641683 s for getting demag matrix 

||MAG_size: 64 || Spin calc speed: 1.2e-02 s || Hd calc speed: 6.7e-03 s||


 +---------------------------Results Summary-----------------------------+
||Unt_size: 64 || Spin calc speed: 1.5e-02 s || Hd calc speed: 9.9e-03 s||
||MAG_size: 64 || Spin calc speed: 1.2e-02 s || Hd calc speed: 6.7e-03 s||
MAG2305 version: UnetHd_Public_2023.10.18

c_gn_test
Unet model loaded

Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 32768
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([128, 128, 2, 3])
||Unt_size: 128 || Spin calc speed: 1.6e-02 s || Hd calc speed: 1.1e-02 s||
MAG2305 version: UnetHd_Public_2023.10.18


Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 32768
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([128, 128, 2, 3])
Demag Matrix SumTest:
  [ 2.62962e-01 -1.69883e-01 -9.16686e-02]
  [-1.69883e-01  2.62962e-01 -9.16686e-02]
  [-9.16686e-02 -9.16686e-02  4.74076e-01]
  trace = 1.00000

Time cost: 6.504464 s for getting demag matrix 

||MAG_size: 128 || Spin calc speed: 1.1e-02 s || Hd calc speed: 9.2e-03 s||


 +---------------------------Results Summary-----------------------------+
||Unt_size: 128 || Spin calc speed: 1.6e-02 s || Hd calc speed: 1.1e-02 s||
||MAG_size: 128 || Spin calc speed: 1.1e-02 s || Hd calc speed: 9.2e-03 s||
MAG2305 version: UnetHd_Public_2023.10.18

c_gn_test
Unet model loaded

Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 131072
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([256, 256, 2, 3])
||Unt_size: 256 || Spin calc speed: 2.7e-02 s || Hd calc speed: 1.4e-02 s||
MAG2305 version: UnetHd_Public_2023.10.18


Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 131072
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([256, 256, 2, 3])
Demag Matrix SumTest:
  [ 2.62518e-01 -1.70691e-01 -9.16731e-02]
  [-1.70691e-01  2.62518e-01 -9.16731e-02]
  [-9.16731e-02 -9.16731e-02  4.74964e-01]
  trace = 1.00000

Time cost: 28.265554 s for getting demag matrix 

||MAG_size: 256 || Spin calc speed: 1.1e-02 s || Hd calc speed: 1.0e-02 s||


 +---------------------------Results Summary-----------------------------+
||Unt_size: 256 || Spin calc speed: 2.7e-02 s || Hd calc speed: 1.4e-02 s||
||MAG_size: 256 || Spin calc speed: 1.1e-02 s || Hd calc speed: 1.0e-02 s||
MAG2305 version: UnetHd_Public_2023.10.18

c_gn_test
Unet model loaded

Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 524288
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([512, 512, 2, 3])
||Unt_size: 512 || Spin calc speed: 6.5e-02 s || Hd calc speed: 5.8e-02 s||
MAG2305 version: UnetHd_Public_2023.10.18


Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 524288
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([512, 512, 2, 3])
Demag Matrix SumTest:
  [ 2.62297e-01 -1.71094e-01 -9.16742e-02]
  [-1.71094e-01  2.62297e-01 -9.16742e-02]
  [-9.16742e-02 -9.16742e-02  4.75406e-01]
  trace = 1.00000

Time cost: 106.476104 s for getting demag matrix 

||MAG_size: 512 || Spin calc speed: 2.7e-02 s || Hd calc speed: 2.8e-02 s||


 +---------------------------Results Summary-----------------------------+
||Unt_size: 512 || Spin calc speed: 6.5e-02 s || Hd calc speed: 5.8e-02 s||
||MAG_size: 512 || Spin calc speed: 2.7e-02 s || Hd calc speed: 2.8e-02 s||
MAG2305 version: UnetHd_Public_2023.10.18

c_gn_test
Unet model loaded

Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 2097152
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([1024, 1024, 2, 3])
||Unt_size: 1024 || Spin calc speed: 2.9e-01 s || Hd calc speed: 2.5e-01 s||
MAG2305 version: UnetHd_Public_2023.10.18


Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 2097152
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([1024, 1024, 2, 3])
Demag Matrix SumTest:
  [ 2.62187e-01 -1.71296e-01 -9.16745e-02]
  [-1.71296e-01  2.62187e-01 -9.16745e-02]
  [-9.16745e-02 -9.16745e-02  4.75626e-01]
  trace = 1.00000

Time cost: 414.833335 s for getting demag matrix 

||MAG_size: 1024 || Spin calc speed: 1.1e-01 s || Hd calc speed: 7.5e-02 s||


 +---------------------------Results Summary-----------------------------+
||Unt_size: 1024 || Spin calc speed: 2.9e-01 s || Hd calc speed: 2.5e-01 s||
||MAG_size: 1024 || Spin calc speed: 1.1e-01 s || Hd calc speed: 7.5e-02 s||
MAG2305 version: UnetHd_Public_2023.10.18

c_gn_test
Unet model loaded

Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 8388608
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([2048, 2048, 2, 3])
||Unt_size: 2048 || Spin calc speed: 1.3e+00 s || Hd calc speed: 1.1e+00 s||
MAG2305 version: UnetHd_Public_2023.10.18


Initialize an mmModel:

  Cuda:0 available. Spin evolution using cuda:0.

  # Cells  : 8388608
  # Matters: 1
  Ms check : 1st 1000.000, last 1000.000   [emu/cc]
  Ax check : 1st 5.00e-07, last 5.00e-07   [erg/cm]
  Ku check : 1st 0.00e+00, last 0.00e+00   [erg/cc]

  Average magnetization  :   1000.00  [emu/cc]
  Maximal anisotropy Hk  : 0.000e+00  [Oe]    
  Maximal Heisenberg Hx  : 1.111e+04  [Oe]    
  Maximal effective Heff : 7.923e+04  [Oe]
  
Creating 2 layer models 

Spin state initialized according to input.

spin shape torch.Size([2048, 2048, 2, 3])
Demag Matrix SumTest:
  [ 2.62132e-01 -1.71396e-01 -9.16745e-02]
  [-1.71396e-01  2.62132e-01 -9.16745e-02]
  [-9.16745e-02 -9.16745e-02  4.75736e-01]
  trace = 1.00000

Time cost: 1629.836087 s for getting demag matrix 

Traceback (most recent call last):
  File "mm_speed.py", line 70, in <module>
    error_mm = film1.SpinLLG_RK4()
  File "/data/home/caiyq/NeuralMAG/libs/MAG2305.py", line 1184, in SpinLLG_RK4
    DSpin = self.GetDSpin_LLG(Hext=Hext, tau=tau, damping=damping)
  File "/data/home/caiyq/NeuralMAG/libs/MAG2305.py", line 1085, in GetDSpin_LLG
    self.GetHeff()
  File "/data/home/caiyq/NeuralMAG/libs/MAG2305.py", line 934, in GetHeff_intrinsic
    self.Demag()
  File "/data/home/caiyq/NeuralMAG/libs/MAG2305.py", line 843, in DemagField_FFT
    H = torch.fft.irfftn( FH, dim=(1,2,3) )
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.12 GiB (GPU 0; 39.44 GiB total capacity; 8.29 GiB already allocated; 411.94 MiB free; 8.38 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF


 +---------------------------Results Summary-----------------------------+
||Unt_size: 2048 || Spin calc speed: 1.3e+00 s || Hd calc speed: 1.1e+00 s||

